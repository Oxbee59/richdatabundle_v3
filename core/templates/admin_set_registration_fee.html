{% extends "base.html" %}
{% load static %}

{% block content %}

<style>
/* MAIN CARD */
.admin-card {
    background: #fff;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 5px 18px rgba(90, 43, 214, 0.15);
    border-left: 5px solid #5a2bd6;
    margin-bottom: 20px;
}

/* FORM INPUTS */
.form-label {
    font-weight: 600;
    color: #5a1ea1;
}

.form-control {
    border-radius: 8px;
    padding: 10px;
    border: 1px solid #ccc;
}

.btn-update {
    background: #5a2bd6;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
}

.btn-update:hover {
    transform: scale(1.05);
}

/* TABLE */
.table-custom {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 10px;
}

.table-custom thead th {
    background: #5a2bd6;
    color: white;
    padding: 12px;
    border-radius: 8px 8px 0 0;
    font-weight: 600;
}

.table-custom tbody tr {
    background: white;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    border-radius: 10px;
}

.table-custom td {
    padding: 12px;
    font-size: 15px;
}

/* MOBILE CARDS */
.fee-card {
    display: none;
}

@media(max-width: 760px) {
    .table-responsive { display: none; }

    .fee-card {
        display: block;
        background: white;
        padding: 15px;
        border-radius: 14px;
        margin-bottom: 15px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    }

    .fee-card p {
        margin: 4px 0;
        font-size: 15px;
    }

    .fee-card .label {
        font-weight: 600;
        color: #5a2bd6;
    }
}
</style>

<h2 style="color:#5a1ea1; font-weight:700; margin-bottom:20px;">Set Registration Fee</h2>

<div class="admin-card">

    <!-- UPDATE FORM -->
    <form method="POST" class="mb-4">
        {% csrf_token %}
        <label class="form-label">Current Fee (₵)</label>
        <input type="number" step="0.01" name="fee" value="{{ settings.agent_registration_fee }}" class="form-control mb-3">
        <button class="btn-update">Update Fee</button>
    </form>

    <!-- DESKTOP TABLE -->
    <h4 style="margin-bottom:12px; color:#5a1ea1;">Recent Fee Changes</h4>
    <div class="table-responsive">
        <table class="table-custom">
            <thead>
                <tr>
                    <th>Fee (₵)</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                </tr>
            </thead>

            <tbody>
                {% for f in fee_history %}
                <tr>
                    <td>₵{{ f.agent_registration_fee }}</td>
                    <td>{{ f.created_at|date:"M d, Y H:i" }}</td>
                    <td>{{ f.updated_at|date:"M d, Y H:i" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="text-align:center; padding:15px;">No history</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- MOBILE CARDS -->
    {% for f in fee_history %}
    <div class="fee-card">
        <p><span class="label">Fee:</span> ₵{{ f.agent_registration_fee }}</p>
        <p><span class="label">Created At:</span> {{ f.created_at|date:"M d, Y H:i" }}</p>
        <p><span class="label">Updated At:</span> {{ f.updated_at|date:"M d, Y H:i" }}</p>
    </div>
    {% endfor %}

</div>

{% endblock %}
