{% extends "base.html" %}
{% block content %}

<style>
    .page-card {
        max-width: 450px;
        margin: 40px auto;
        background: #fff;
        padding: 25px;
        border-radius: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        font-family: Arial, sans-serif;
    }
    .page-card h2 {
        text-align: center;
        color: #6a0dad;
        margin-bottom: 20px;
    }
    .wallet-box {
        background: #f8f1ff;
        padding: 12px;
        border-radius: 8px;
        text-align: center;
        font-weight: bold;
        color: #520a9e;
        margin-bottom: 20px;
    }
    .page-card label {
        font-weight: bold;
        margin-top: 10px;
        display: block;
    }
    .page-card input,
    .page-card select {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        margin-bottom: 15px;
        box-sizing: border-box;
        font-size: 14px;
    }
    .btn-primary {
        background: #6a0dad;
        color: #fff;
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
        font-size: 16px;
    }
    .btn-primary:hover {
        background: #520a9e;
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background: rgba(0,0,0,0.6);
    }
    .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border-radius: 12px;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .modal-content p {
        font-size: 16px;
        margin-bottom: 20px;
    }
    .modal-btn {
        padding: 10px 20px;
        margin: 5px;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
    }
    .modal-confirm {
        background: #6a0dad;
        color: #fff;
    }
    .modal-confirm:hover {
        background: #520a9e;
    }
    .modal-cancel {
        background: #ccc;
        color: #333;
    }
    .modal-cancel:hover {
        background: #aaa;
    }
</style>

<div class="page-card">
    <h2>Withdraw Commission</h2>

    <div class="wallet-box">
        Available Commission: GHS {{ available_commission }}
    </div>

    <form method="POST" id="withdrawForm">
        {% csrf_token %}

        <label>Amount to Withdraw</label>
        <input type="number" name="amount" id="amount" min="1" max="{{ available_commission }}" step="0.01" required>

        <label>Mobile Money Number</label>
        <input type="text" name="mobile_number" id="mobile_number" placeholder="e.g. 024XXXXXXX" required>

        <label>Network</label>
        <select name="network" id="network" required>
            <option value="MTN">MTN</option>
            <option value="Vodafone">Vodafone</option>
            <option value="AirtelTigo">AirtelTigo</option>
        </select>

        <button class="btn-primary" type="button" id="withdrawBtn">Withdraw Now</button>
    </form>
</div>

<!-- Modal -->
<div id="confirmModal" class="modal">
    <div class="modal-content">
        <p id="modalText"></p>
        <button class="modal-btn modal-confirm" id="confirmBtn">Confirm</button>
        <button class="modal-btn modal-cancel" id="cancelBtn">Cancel</button>
    </div>
</div>

<script>
    const withdrawBtn = document.getElementById("withdrawBtn");
    const modal = document.getElementById("confirmModal");
    const modalText = document.getElementById("modalText");
    const confirmBtn = document.getElementById("confirmBtn");
    const cancelBtn = document.getElementById("cancelBtn");
    const form = document.getElementById("withdrawForm");

    withdrawBtn.addEventListener("click", () => {
        const amount = document.getElementById("amount").value;
        const number = document.getElementById("mobile_number").value;
        const network = document.getElementById("network").value;

        if (!amount || !number || !network) {
            alert("Please fill all fields.");
            return;
        }

        modalText.textContent = `You are about to withdraw GHS ${amount} to ${number} on ${network}. Proceed?`;
        modal.style.display = "block";
    });

    confirmBtn.addEventListener("click", () => {
        form.submit();
    });

    cancelBtn.addEventListener("click", () => {
        modal.style.display = "none";
    });

    // Close modal when clicking outside
    window.addEventListener("click", (e) => {
        if (e.target == modal) modal.style.display = "none";
    });
</script>

{% endblock %}