{% extends "base.html" %}
{% block content %}
<div class="page" style="max-width:1000px;margin:auto; padding:15px;">

    <h2 style="color:#6a0dad; margin-bottom:20px;">Admin Dashboard</h2>

    <!-- METRICS CARDS -->
    <div class="metrics-grid">
        <div class="metric-card primary">
            <h4>Total Agents</h4>
            <p>{{ total_agents }}</p>
        </div>
        <div class="metric-card">
            <h4>Total Wallet Funds</h4>
            <p>GHS {{ total_wallets }}</p>
        </div>
        <div class="metric-card">
            <h4>Orders Today</h4>
            <p>{{ total_orders_today }}</p>
        </div>
    </div>

    <!-- ACTION BUTTONS -->
    <div class="actions">
        <button class="btn-primary" onclick="window.location.href='/admin/add-bundle/'">âž• Add Bundle</button>
        <button class="btn-primary" onclick="window.location.href='/admin/update-wallet/'">ðŸ’° Fund Agent</button>
        <button class="btn-primary" onclick="window.location.href='/admin/set-registration-fee/'">ðŸ“‹ Set Registration Fee</button>
    </div>

    <!-- RECENT CONTACT MESSAGES -->
    <h3 class="section-title">Recent Contact Messages</h3>
    <div class="table-container">
        <table>
            <tr>
                <th>From</th>
                <th>Subject</th>
                <th>Message</th>
                <th>Date</th>
            </tr>
            {% for msg in contact_messages %}
            <tr>
                <td>{{ msg.user.username if msg.user else msg.email }}</td>
                <td>{{ msg.subject }}</td>
                <td>{{ msg.message|truncatewords:15 }}</td>
                <td>{{ msg.created_at|date:"M d, Y H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align:center;">No messages yet.</td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <!-- BUNDLES -->
    <h3 class="section-title" style="margin-top:30px;">Current Bundles</h3>
    <div class="bundle-grid">
        {% for b in bundles %}
        <div class="bundle-card">
            <strong>{{ b.network }} â€¢ {{ b.name }}</strong><br>
            GHS {{ b.price }} <br>
            {% if b.send_via_api %}<small style="color:#6a0dad;">API</small>{% else %}Admin{% endif %}
        </div>
        {% empty %}
        <p>No bundles yet.</p>
        {% endfor %}
    </div>

</div>

<!-- STYLES -->
<style>
.metrics-grid {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
    gap:15px;
    margin-bottom:25px;
}
.metric-card {
    background:white;
    padding:20px;
    border-radius:12px;
    box-shadow:0 3px 10px rgba(0,0,0,0.1);
}
.metric-card.primary {
    background:#6a0dad;
    color:white;
}
.metric-card p { font-size:22px; font-weight:bold; margin-top:5px; }

.actions {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:15px;
    margin-bottom:25px;
}

.btn-primary {
    background:#6a0dad;
    color:white;
    padding:12px 18px;
    border:none;
    border-radius:8px;
    font-weight:500;
    cursor:pointer;
    width:100%;
}
.btn-primary:hover { background:#501393; transform:scale(1.04); }

.table-container { overflow-x:auto; margin-bottom:25px; }
table { width:100%; border-collapse:collapse; background:white; border-radius:10px; overflow:hidden; box-shadow:0 2px 10px rgba(0,0,0,0.08);}
th { background:#f0e8ff; padding:12px; text-align:left; color:#6a0dad; }
td { padding:12px; border-bottom:1px solid #eee; }

.bundle-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px; }
.bundle-card { background:#fafafa; border-radius:10px; padding:10px; text-align:center; box-shadow:0 1px 6px rgba(0,0,0,0.08); }

.section-title { color:#6a0dad; font-weight:700; margin-bottom:10px; }

@media(max-width:600px){
    .metric-card p { font-size:18px; }
    .btn-primary { padding:10px; }
    th, td { font-size:13px; }
}
</style>

{% endblock %}
